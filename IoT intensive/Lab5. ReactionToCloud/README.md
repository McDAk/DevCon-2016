#DevCon 2016: IoT-интенсив 

# Лабораторная 5: Посылаем время реакции в облако

В этом упражнении мы соберем время нашей реакции, измеренное приложением из лабораторной 2, и пошлем его в единый IoT-хаб в облаке.

## Подключаемся к IoT Hub и создаем запись для своего устройства

В Device Explorer задаём следующую строку подключения к IoT Hub:
```
HostName=ReactionHub.azure-devices.net;SharedAccessKeyName=iothubowner;SharedAccessKey=WNdnI84fzl5LFpIOAyRo2lgqqUWnrM5B4soRo769L70=
```

## Получите приложение из GitHub и исправьте константы

Чтобы исключить разницу от программного кода, мы все будем использовать одну и ту же версию приложения, загруженную с GitHub. Получите
приложение Lab5 и исправьте в коде константы в соответствии со своими данными:

```
        string Id = "rpi3";
        string DeviceConnectionString = "HostName=ReactionHub.azure-devices.net;DeviceId=rpi3;SharedAccessKey=uG8tNYl+RfEF312enlGh62HP8RrB8vNGUFEcSQ0m7gQ=";
        string Nick = "shwars";
        int Age = 42;
        string Sex = "M";
        int Dizz = 0;
        // 0 - нормальное состояние
        // 1 - 5 поворотов вокруг своей оси
        // 2 - 10 поворотов вокруг своей оси

        private int DeviceType = 0;
        // 0 - Raspberry Pi
        // 1 - PC UWP

```

Затем скомпилируйте приложение **в конфигурации Release**, загрузите его на устройство, и измерьте время реакции в трех случаях:

  * В нормальном состоянии после запуска (сделайте минимум 10 замеров)
  * После 10 поворотов вокруг свой оси (сделайте минимум 3 подхода по 3 замера)
  * После 20 поворотов вокруг свое оси (3 подхода по 3 замера)

Между замерами останавливайте приложение и меняйте в коде соответствующие константы, чтобы в IoT Hub были записаны правильные данные.

Все данные со всех устройств оказываются в едином хранилище Azure Table Storage, к которому вы можете подключиться с помощью приложения
[Azure Storage Explorer](https://azurestorageexplorer.codeplex.com/). Параметры для подключения:

  * Название: `devconstore`
  * Ключ доступа: `8xi4h10NyQnfehpbX+Xwf0xcznDANUHhEBvZpgoQ43ZzJawTyBmcQSbtcleOIrVVzUvrNoA1U0pDxYFck9L/PQ==`

## Проанализируйте данные с помощью Azure Machine Learning

Возьмите таблицу со всеми накопленными данными и попробуйте провести некоторый анализ с помощью Azure ML:

  1. Отфильтруйте только свои данные и посмотрите, от чего зависит время реакции (используйте Compute Linear Correlation)
  2. Отфильтруйте только свои данные и выберите атрибуты, от которых больше всего зависит время реакции (используйте Filter Based Feature Selection) 
  3. Обучите модель линейной регрессии на выбранных атрибутах и посмотрите, какие получились коэффициенты
  4. Уберите фильтр на свои данные и посмотрите, зависит ли время реакции от пола, возраста и других параметров.
  5. Попробуйте обучить модель линейной регрессии на всех данных.
